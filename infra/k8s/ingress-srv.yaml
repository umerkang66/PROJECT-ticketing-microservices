apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: ingress-service
  annotations:
    kubernetes.io/ingress.class: nginx
    # This overall annotations right here is telling nginx that in the bottom of the file where we will be specifying some paths, will have some regular expressions inside of them
    nginx.ingress.kubernetes.io/use-regex: 'true'
spec:
  rules:
    # Host is some pretend domain name, that we can connect only from our local machine, we also have to edit the host file
    - host: ticketing.dev
      http:
        paths:
          # When the request hit the server and the request has "/api/users/(anything)" we need to send that request on to this listed
          - path: /api/users/?(.*)
            pathType: Prefix
            backend:
              # This name is coming from right there from the service we created just a moment ago inside our auth-depl file and we want to make sure that we send the request on port 3000, because that is listed in auth-depl file (also that is the port that our application is expecting in the express application)
              service:
                name: auth-srv
                port:
                  number: 3000
